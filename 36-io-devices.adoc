= 36 I/O Devices
:figure-caption: Figure 36.
:imagesdir: images
:toc: left

* Before delving into the main content of this part of the book (on
  persistence), we first introduce the concept of an *input/output (I/O)
  device* and show how the operating system might interact with such an
  entity.
* I/O is quite critical to computer systems, of course; imagine a program
  without any input (it produces the same result each time); now imagine a
  program with no output (what was the purpose of it running?).
* Clearly, for computer systems to be interesting, both input and output are
  required.
* And thus, our general problem:

.Crux: How to integrate I/O into systems
****
* How should I/O be integrated into systems?
* What are the general mechanisms?
* How can we make them efficient?
****

== 36.1 System Architecture

* To begin our discussion, let's look at a "classical" diagram of a typical
  system (Figure 36.1, page 2).
* The picture shows a single CPU attached to the main memory of the system via
  some kind of *memory bus* or interconnect.
* Some devices are connected to the system via a general *I/O bus*, which in
  many modern systems would be *PCI* (or one of its many derivatives);
  graphics and some other higher-performance I/O devices might be found here.
* Finally, even lower down are one or more of what we call a *peripheral bus*,
  such as *SCSI*, *SATA*, or *USB*.
* These connect slow devices to the system, including *disks*, *mice*, and
  *keyboards*.

.Prototypical System Architecture
image::figure-36-01.png[]

* One question you might ask is: why do we need a hierarchical structure like
  this?
* Put simply: physics, and cost.
* The faster a bus is, the shorter it must be; thus, a high-performance memory
  bus does not have much room to plug devices and such into it.
* In addition, engineering a bus for high performance is quite costly.
* Thus, system designers have adopted this hierarchical approach, where
  components that demand high performance (such as the graphics card) are
  nearer the CPU.
* Lower performance components are further away.
* The benefits of placing disks and other slow devices on a peripheral bus are
  manifold; in particular, you can place a large number of devices on it.

'''

* Of course, modern systems increasingly use specialized chipsets and faster
  point-to-point interconnects to improve performance.
* Figure 36.2 (page 3) shows an approximate diagram of Intel's Z270 Chipset
  [H17].
* Along the top, the CPU connects most closely to the memory system, but also
  has a high-performance connection to the graphics card (and thus, the
  display) to enable gaming (oh, the horror!) and other graphics-intensive
  applications.

.Modern System Architecture
image::figure-36-02.png[]

* The CPU connects to an I/O chip via Intel's proprietary *DMI* (*Direct Media
  Interface*), and the rest of the devices connect to this chip via a number
  of different interconnects.
* On the right, one or more hard drives connect to the system via the *eSATA*
  interface; *ATA* (the *AT Attachment*, in reference to providing connection
  to the IBM PC AT), then *SATA* (for *Serial ATA*), and now *eSATA* (for
  *external SATA*) represent an evolution of storage interfaces over the past
  decades, with each step forward increasing performance to keep pace with
  modern storage devices.

'''

* Below the I/O chip are a number of *USB* (*Universal Serial Bus*)
  connections, which in this depiction enable a keyboard and mouse to be
  attached to the computer.
* On many modern systems, USB is used for low performance devices such as
  these.

'''

* Finally, on the left, other higher performance devices can be connected to
  the system via *PCIe* (*Peripheral Component Interconnect Express*).
* In this diagram, a network interface is attached to the system here; higher
  performance storage devices (such as *NVMe* persistent storage devices) are
  often connected here.

== References

[H17] "Intel Core i7-7700K review: Kaby Lake Debuts for Desktop" by Joel Hruska. January 3, 2017. `www.extremetech.com/extreme/241950-intels-core-i7-7700k-reviewed-kaby-lake-debuts-desktop.`::
* An in-depth review of a recent Intel chipset, including CPUs and the I/O
  subsystem.
